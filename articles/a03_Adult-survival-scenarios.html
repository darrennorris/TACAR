<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Adult survival scenarios • TACAR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adult survival scenarios">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TACAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01_Interactive-map.html">Population change map</a></li>
    <li><a class="dropdown-item" href="../articles/a02_Matrix-population-model-projections.html">Matrix population model projections</a></li>
    <li><a class="dropdown-item" href="../articles/a03_Adult-survival-scenarios.html">Adult survival scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/a13_prep_river_points.html">Prepare river points</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/darrennorris/TACAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Adult survival scenarios</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/darrennorris/TACAR/blob/main/vignettes/a03_Adult-survival-scenarios.Rmd" class="external-link"><code>vignettes/a03_Adult-survival-scenarios.Rmd</code></a></small>
      <div class="d-none name"><code>a03_Adult-survival-scenarios.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darrennorris.github.io/TACAR/">TACAR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">popdemo</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">popbio</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rcompadre" class="external-link">Rcompadre</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="population-scenarios">Population scenarios<a class="anchor" aria-label="anchor" href="#population-scenarios"></a>
</h2>
<p>Establish distribution of plausible adult survival values in the
following scenarios:</p>
<ul>
<li>Unharvested, with and without recovery actions.</li>
<li>Lightly harvested, with and without recovery actions.</li>
<li>Intesively harvested, with and without recovery actions.</li>
</ul>
<p>The “unharvested” scenario represents the baseline reference against
which the others will be measured. To be able to compare with and
without recovery actions we need to include density dependence in the
matrix projection models.</p>
<p>We use estimates of longevity to establish mean and range of annual
adult female survival in populations for each scenario. This is then
used to estimate the distribution “today”, before considering the effect
of future actions (either positive e.g.  recovery or negative
e.g. continued harvest).</p>
<ul>
<li><p>Unharvested (“none”),<br>
mean 57.1 years, range 20 to 70 years, beta distribution.</p></li>
<li><p>Lightly harvested (“low” - less than 5% per year),<br>
mean 22 years, range 12.2 (9 plus 3 nesting seasons) to 50 years, beta
distribution.</p></li>
<li><p>Intensively harvested (“high” - greater than 10% per year),<br>
mean 12.2 years, range 9 (reproduces at least once) to 30 years,
half-normal distribution.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adult_survival</span> <span class="op">&lt;-</span> <span class="fu">TACAR</span><span class="fu">::</span><span class="fu"><a href="../reference/make_beta.html">make_beta</a></span><span class="op">(</span>survival_mean <span class="op">=</span> <span class="fl">0.976987</span>, </span>
<span>                                      survival_min <span class="op">=</span> <span class="fl">0.9215</span>, </span>
<span>                                      survival_max <span class="op">=</span> <span class="fl">0.98153</span>, </span>
<span>                                   alpha <span class="op">=</span> <span class="fl">40</span>, beta <span class="op">=</span> <span class="fl">40</span></span>
<span>                                   <span class="op">)</span></span>
<span><span class="co">#&gt; Warning in TACAR::make_beta(survival_mean = 0.976987, survival_min = 0.9215, :</span></span>
<span><span class="co">#&gt; Less than 50% of survival values are within the desired range. Rescaling</span></span>
<span><span class="co">#&gt; values.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">adult_survival</span><span class="op">$</span><span class="va">within_range</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/survival-distributions-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">adult_survival</span><span class="op">$</span><span class="va">within_range</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9720561</span></span>
<span></span>
<span><span class="va">adult_survival_hunt_low</span> <span class="op">&lt;-</span> <span class="fu">TACAR</span><span class="fu">::</span><span class="fu"><a href="../reference/make_beta.html">make_beta</a></span><span class="op">(</span>survival_mean <span class="op">=</span> <span class="fl">0.9326</span>, </span>
<span>                                      survival_min <span class="op">=</span> <span class="fl">0.8407</span>, </span>
<span>                                      survival_max <span class="op">=</span> <span class="fl">0.97339</span>, </span>
<span>                                   alpha <span class="op">=</span> <span class="fl">40</span>, beta <span class="op">=</span> <span class="fl">30</span></span>
<span>                                   <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">adult_survival_hunt_low</span><span class="op">$</span><span class="va">within_range</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/survival-distributions-2.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">adult_survival_hunt_low</span><span class="op">$</span><span class="va">within_range</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9300917</span></span>
<span></span>
<span><span class="va">adult_survival_hunt_high</span> <span class="op">&lt;-</span> <span class="fu">TACAR</span><span class="fu">::</span><span class="fu"><a href="../reference/make_half_normal.html">make_half_normal</a></span><span class="op">(</span>survival_mean <span class="op">=</span> <span class="fl">0.8407</span>,</span>
<span>                                                    survival_min <span class="op">=</span> <span class="fl">0.7363</span>, </span>
<span>                                                    survival_max <span class="op">=</span> <span class="fl">0.9525</span><span class="op">)</span></span>
<span><span class="co"># Plot the distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">adult_survival_hunt_high</span><span class="op">$</span><span class="va">survival_values</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/survival-distributions-3.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">adult_survival_hunt_high</span><span class="op">$</span><span class="va">survival_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7889249</span></span></code></pre></div>
<p>Compare the survival in populations under different hunting
pressure.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_survival</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"beta"</span>, hunt_level <span class="op">=</span> <span class="st">"a_none"</span>, </span>
<span>           female_survival <span class="op">=</span> <span class="va">adult_survival</span><span class="op">$</span><span class="va">within_range</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"beta"</span>, hunt_level <span class="op">=</span> <span class="st">"b_low"</span>, </span>
<span>           female_survival <span class="op">=</span> <span class="va">adult_survival_hunt_low</span><span class="op">$</span><span class="va">within_range</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"half-normal"</span>, hunt_level <span class="op">=</span> <span class="st">"c_high"</span>, </span>
<span>           female_survival <span class="op">=</span> <span class="va">adult_survival_hunt_high</span><span class="op">$</span><span class="va">survival_values</span><span class="op">)</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">df_survival</span><span class="op">$</span><span class="va">hunt_levelf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df_survival</span><span class="op">$</span><span class="va">hunt_level</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">df_survival</span><span class="op">$</span><span class="va">hunt_levelf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="va">growth_survival</span> <span class="op">&lt;-</span> <span class="va">survival_longevity</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">survival_longevity</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">female_survival</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">mylabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.75\n(9.5 Y)"</span>, <span class="st">"0.85\n(12.7 Y)"</span>, <span class="st">"0.95\n(28.8 Y)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_survival</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">female_survival</span>, </span>
<span>                               group <span class="op">=</span> <span class="va">hunt_levelf</span>, fill <span class="op">=</span> <span class="va">hunt_levelf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, adjust <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">growth_survival</span><span class="op">)</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co">#annotate("label", x = growth_survival, y = 25, label = "Some text") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="st">"harvest"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.85</span>, <span class="fl">0.95</span><span class="op">)</span>, </span>
<span>                     labels <span class="op">=</span> <span class="va">mylabels</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Female survival"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/plot-density-1.png" width="700"></p>
<p>The figure above shows the distribution of adult female survival in
populations under threee different scenarios. The x axis shows survival
values, together with overall life expectancy in parentheses. The
vertical blue line shows where lambda equals one, and indicates where
populations are growing to the right.</p>
<p>We can now use these distributions to explore how the populations are
likely to change in the future. Here we follow the element selection
example: <a href="https://cran.r-project.org/web/packages/popdemo/vignettes/popdemo.html#72_Nonrandom_matrix_selection" class="external-link uri">https://cran.r-project.org/web/packages/popdemo/vignettes/popdemo.html#72_Nonrandom_matrix_selection</a></p>
<p>First run an example using the Intensively harvested population, with
harvest at 13% a year.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get matrix</span></span>
<span><span class="co"># projection parameters</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">TACAR</span><span class="fu">::</span><span class="fu"><a href="../reference/pop01_param_poun.html">pop01_param_poun</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Population size constant.</span></span>
<span><span class="va">nf</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">adultF_n</span> <span class="op">&lt;-</span> <span class="va">nf</span></span>
<span></span>
<span><span class="co"># No data on density dependence for any South American freshwater turtle.</span></span>
<span><span class="co"># Here include a generous 20% ceiling on maximum population increase </span></span>
<span><span class="co"># in the case of harvested populations.</span></span>
<span><span class="va">ceiling_threshold_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">nf</span> <span class="op">+</span> <span class="op">(</span><span class="va">nf</span> <span class="op">*</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ceiling_threshold_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">nf</span> <span class="op">+</span> <span class="op">(</span><span class="va">nf</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ceiling_threshold_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">nf</span> <span class="op">+</span> <span class="op">(</span><span class="va">nf</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Matrix from data.frame</span></span>
<span><span class="va">stage_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a1"</span>, <span class="st">"a2"</span>, <span class="st">"a3"</span>, <span class="st">"a4"</span>,</span>
<span>                   <span class="st">"b1"</span>, <span class="st">"b2"</span>, <span class="st">"b3"</span>, <span class="st">"b4"</span>,</span>
<span>                   <span class="st">"c1"</span>, <span class="st">"c2"</span>, <span class="st">"c3"</span>, <span class="st">"c4"</span>,</span>
<span>                   <span class="st">"d1"</span>, <span class="st">"d2"</span>, <span class="st">"d3"</span>, <span class="st">"d4"</span><span class="op">)</span></span>
<span><span class="va">vpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">dt</span><span class="op">[</span><span class="fl">3</span> , <span class="va">stage_names</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pop_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">vpop</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">pop_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_1"</span>, <span class="st">"_2"</span>, <span class="st">"_3"</span>, <span class="st">"_4"</span><span class="op">)</span>,</span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># stable stage structure</span></span>
<span>  <span class="va">pop_ss</span> <span class="op">&lt;-</span> <span class="fu">popdemo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html" class="external-link">eigs</a></span><span class="op">(</span><span class="va">pop_mat</span>, <span class="st">"ss"</span><span class="op">)</span></span>
<span>  <span class="co"># stable stage population numbers corresponding to number of females</span></span>
<span>  <span class="va">pop_n</span> <span class="op">&lt;-</span>  <span class="va">nf</span> <span class="op">*</span> <span class="op">(</span><span class="va">pop_ss</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">pop_ss</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#create list of 100 matrices</span></span>
<span><span class="va">ntimes</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">pop_mat_100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pop_mat</span><span class="op">)</span>, <span class="va">ntimes</span><span class="op">)</span></span>
<span><span class="co">#replace [d, 4] element of every matrix with new random number</span></span>
<span><span class="va">a44</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">adult_survival_hunt_high</span><span class="op">$</span><span class="va">survival_values</span><span class="op">)</span>, </span>
<span>              size <span class="op">=</span> <span class="va">ntimes</span><span class="op">)</span></span>
<span><span class="va">pop_mat_100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">A</span>, <span class="va">r</span><span class="op">)</span><span class="op">{</span><span class="va">A</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">r</span>; <span class="va">A</span><span class="op">}</span>, <span class="va">pop_mat_100</span>, <span class="va">a44</span>, </span>
<span>                      SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Deterministic</span></span>
<span><span class="co"># Average difference (0.976987 - 0.8407) / 0.976987 = 0.139</span></span>
<span><span class="va">pop_mat_high</span> <span class="op">&lt;-</span> <span class="va">pop_mat</span></span>
<span><span class="va">pop_mat_high</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pop_mat</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span><span class="va">pop_mat</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="fl">0.139</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Project and plot</span></span>
<span><span class="va">poun_high</span> <span class="op">&lt;-</span> <span class="fu">popdemo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">pop_mat_100</span>, vector <span class="op">=</span> <span class="va">pop_n</span>, Aseq <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">ntimes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/Projection-plots.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">poun_high</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">ntimes</span>, <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">pop_mat_high</span>, <span class="va">pop_n</span>, time <span class="op">=</span> <span class="va">ntimes</span><span class="op">)</span>, </span>
<span>      lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/project-survival-1.png" width="700"></p>
<p>With continued harvest and no conservation actions the population
declines rapidly. We now repeat the process and compare future changes
for the three different scenarios.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No hunting</span></span>
<span><span class="va">pop_mat_100_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pop_mat</span><span class="op">)</span>, <span class="va">ntimes</span><span class="op">)</span></span>
<span><span class="co">#replace [d, 4] element of every matrix with new random number</span></span>
<span><span class="va">a44_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">adult_survival</span><span class="op">$</span><span class="va">within_range</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">ntimes</span><span class="op">)</span></span>
<span><span class="co"># Update values</span></span>
<span><span class="va">pop_mat_100_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">A</span>, <span class="va">r</span><span class="op">)</span><span class="op">{</span><span class="va">A</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">r</span>; <span class="va">A</span><span class="op">}</span>, </span>
<span>                           <span class="va">pop_mat_100_none</span>, <span class="va">a44_none</span>, </span>
<span>                      SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Project</span></span>
<span><span class="va">poun_none</span> <span class="op">&lt;-</span> <span class="fu">popdemo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, </span>
<span>                              vector <span class="op">=</span> <span class="va">pop_n</span>, Aseq <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">ntimes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Low hunting</span></span>
<span><span class="va">pop_mat_100_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pop_mat</span><span class="op">)</span>, <span class="va">ntimes</span><span class="op">)</span></span>
<span><span class="co">#replace [d, 4] element of every matrix with new random number</span></span>
<span><span class="va">a44_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">adult_survival_hunt_low</span><span class="op">$</span><span class="va">within_range</span><span class="op">)</span>, </span>
<span>                  size <span class="op">=</span> <span class="va">ntimes</span><span class="op">)</span></span>
<span><span class="co"># No do not add additional "Perturbation" of 2.5% harvest</span></span>
<span><span class="co"># a44_low &lt;- (a44_low - (a44_low * 0.025))</span></span>
<span><span class="co"># Update values</span></span>
<span><span class="va">pop_mat_100_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">A</span>, <span class="va">r</span><span class="op">)</span><span class="op">{</span><span class="va">A</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">r</span>; <span class="va">A</span><span class="op">}</span>, </span>
<span>                           <span class="va">pop_mat_100_low</span>, <span class="va">a44_low</span>, </span>
<span>                      SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Project</span></span>
<span><span class="va">poun_low</span> <span class="op">&lt;-</span> <span class="fu">popdemo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">pop_mat_100_low</span>, </span>
<span>                              vector <span class="op">=</span> <span class="va">pop_n</span>, Aseq <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">ntimes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data for plotting-Adult females at each time point for each scenario.</span></span>
<span><span class="va">len</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">poun_none</span><span class="op">)</span></span>
<span><span class="va">Time.intervals</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">len</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">adult_fe_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">poun_none</span> <span class="op">*</span> <span class="op">(</span><span class="fu">popbio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popbio/man/stable.stage.html" class="external-link">stable.stage</a></span><span class="op">(</span><span class="va">pop_mat</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adult_fe_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">poun_low</span> <span class="op">*</span> <span class="op">(</span><span class="fu">popbio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popbio/man/stable.stage.html" class="external-link">stable.stage</a></span><span class="op">(</span><span class="va">pop_mat</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adult_fe_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">poun_high</span> <span class="op">*</span> <span class="op">(</span><span class="fu">popbio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popbio/man/stable.stage.html" class="external-link">stable.stage</a></span><span class="op">(</span><span class="va">pop_mat</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_adult_female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Time.intervals</span>, hunt_level <span class="op">=</span> <span class="st">"a_none"</span>, </span>
<span>           females <span class="op">=</span> <span class="va">adult_fe_none</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Time.intervals</span>, hunt_level <span class="op">=</span> <span class="st">"b_low"</span>, </span>
<span>           females <span class="op">=</span> <span class="va">adult_fe_low</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Time.intervals</span>, hunt_level <span class="op">=</span> <span class="st">"c_high"</span>, </span>
<span>           females <span class="op">=</span> <span class="va">adult_fe_high</span><span class="op">)</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">df_adult_female</span><span class="op">$</span><span class="va">hunt_levelf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df_adult_female</span><span class="op">$</span><span class="va">hunt_level</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">df_adult_female</span><span class="op">$</span><span class="va">hunt_levelf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_adult_female</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">females</span>, </span>
<span>                                   group <span class="op">=</span> <span class="va">hunt_levelf</span>, </span>
<span>                                   colour <span class="op">=</span> <span class="va">hunt_levelf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>transform <span class="op">=</span> <span class="st">"log1p"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_d</a></span><span class="op">(</span><span class="st">"harvest"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/compare-scenarios-1.png" width="700"></p>
<p>These models are useful but could be more realisitic. The figure
above shows that with no or little hunting the population numbers
increase at such an unrealistic rate that we need to use a log scale to
compare with the intensively harvested population.</p>
<p>For example, to enable us to explore potential future impacts of
conservation actions it is important to consider how density dependence
will affect the survival and transient dynamics of recovering
populations. This will enable more robust estimation of expected
outcomes and answer questions such as how long will recovery take and
how much will recovery cost?</p>
</div>
<div class="section level2">
<h2 id="density-dependence">Density dependence<a class="anchor" aria-label="anchor" href="#density-dependence"></a>
</h2>
<p>Working on it ………</p>
<p>Example using Chrissy´s new function for a threshold-based
approach.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Under no hunting, we would follow pop_mat_100_none.</span></span>
<span><span class="va">pop_mat_nohunt</span><span class="op">&lt;-</span> <span class="va">pop_mat_100_none</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">pop_mat_nohunt</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">a44_none</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For a high-density population, let's say that they would have a lambda value</span></span>
<span><span class="co"># of 1 on average. We can knock down the population growth rate to 1 by dividing the</span></span>
<span><span class="co"># fertility entries by R0:</span></span>
<span><span class="co"># No - high density populations should decline.</span></span>
<span><span class="va">R0</span><span class="op">&lt;-</span> <span class="fu">popbio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popbio/man/net.reproductive.rate.html" class="external-link">net.reproductive.rate</a></span><span class="op">(</span><span class="va">pop_mat_nohunt</span><span class="op">)</span></span>
<span><span class="va">nohunt_highD</span><span class="op">&lt;-</span> <span class="va">pop_mat_nohunt</span></span>
<span><span class="va">nohunt_highD</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">nohunt_highD</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span><span class="op">/</span><span class="va">R0</span></span>
<span><span class="co"># Check the lambda value:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">nohunt_highD</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="co"># Try out the DD projection function when we use a single matrix:</span></span>
<span><span class="va">nohunt_threshold</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, threshold<span class="op">=</span><span class="fl">1000</span>, A_DD<span class="op">=</span><span class="va">nohunt_highD</span><span class="op">)</span></span>
<span><span class="va">nohunt_threshold_500</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, threshold<span class="op">=</span><span class="fl">500</span>, A_DD<span class="op">=</span><span class="va">nohunt_highD</span><span class="op">)</span></span>
<span><span class="co">#population can double to 310 before DD - why do females increase fourfold?</span></span>
<span><span class="va">nohunt_threshold_x2</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, </span>
<span>                                         vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, </span>
<span>                                         threshold<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pop_n</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                                         A_DD<span class="op">=</span><span class="va">nohunt_highD</span><span class="op">)</span></span>
<span><span class="co"># Plot the result:</span></span>
<span><span class="va">data_adults</span><span class="op">&lt;-</span> <span class="va">nohunt_threshold</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">data_adults_500</span><span class="op">&lt;-</span> <span class="va">nohunt_threshold_500</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> </span>
<span><span class="va">data_adults_x2</span><span class="op">&lt;-</span> <span class="va">nohunt_threshold_x2</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/Projection-plots.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_adults</span>, type<span class="op">=</span><span class="st">'l'</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">'Time'</span>, ylab<span class="op">=</span><span class="st">'N adult females'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, <span class="va">data_adults_500</span>, lwd<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, <span class="va">data_adults_x2</span>, lwd<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/threshold-dd-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># If we want to keep the stochasticity, but we want to drop the reproductive</span></span>
<span><span class="co"># output when the population is above the threshold size, we can divide the</span></span>
<span><span class="co"># reproductive output in the whole series of population matrices by R0:</span></span>
<span><span class="va">pop_mat_100_none_highdens</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span><span class="op">/</span><span class="va">R0</span>; <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try out the DD projection function when we still have stochasticity:</span></span>
<span><span class="va">nohunt_threshold_stoch</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, threshold<span class="op">=</span><span class="fl">1000</span>, A_DD<span class="op">=</span><span class="va">pop_mat_100_none_highdens</span><span class="op">)</span></span>
<span><span class="va">nohunt_threshold_stoch_500</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, threshold<span class="op">=</span><span class="fl">500</span>, A_DD<span class="op">=</span><span class="va">pop_mat_100_none_highdens</span><span class="op">)</span></span>
<span><span class="co">#population can double to 310 before DD - why do females increase fourfold?</span></span>
<span><span class="va">nohunt_threshold_stoch_x2</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, </span>
<span>                                              vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, </span>
<span>                                              threshold<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pop_n</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                                              A_DD<span class="op">=</span><span class="va">pop_mat_100_none_highdens</span><span class="op">)</span></span>
<span><span class="co"># Plot the result:</span></span>
<span><span class="va">data_adults_stoch</span><span class="op">&lt;-</span> <span class="va">nohunt_threshold_stoch</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">data_adults_stoch_500</span><span class="op">&lt;-</span> <span class="va">nohunt_threshold_stoch_500</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">data_adults_stoch_x2</span><span class="op">&lt;-</span> <span class="va">nohunt_threshold_stoch_x2</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/Projection-plots.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_adults_stoch</span>, type<span class="op">=</span><span class="st">'l'</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">'Time'</span>, </span>
<span>     ylab<span class="op">=</span><span class="st">'N adult females'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, <span class="va">data_adults_stoch_500</span>, lwd<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, <span class="va">data_adults_stoch_x2</span>, lwd<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/threshold-dd-2.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># For populations that do not experience hunting - a threshold of 10%</span></span>
<span><span class="co"># seems reasonable.</span></span>
<span><span class="co"># Number of adult females should stay around 10 - 11</span></span>
<span><span class="co"># Mean matrix</span></span>
<span><span class="va">pop_mat_mean_none</span> <span class="op">&lt;-</span> <span class="fu">Rcompadre</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/mpm_mean.html" class="external-link">mat_mean</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span><span class="op">)</span></span>
<span><span class="co"># stable stage structure</span></span>
<span><span class="va">pop_ss_none</span> <span class="op">&lt;-</span> <span class="fu">popdemo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html" class="external-link">eigs</a></span><span class="op">(</span><span class="va">pop_mat_mean_none</span>, <span class="st">"ss"</span><span class="op">)</span></span>
<span><span class="co"># stable stage population numbers corresponding to number of females</span></span>
<span><span class="va">nf_thresh_none</span> <span class="op">&lt;-</span> <span class="va">nf</span><span class="op">*</span><span class="fl">1.1</span> <span class="co"># 10% increase plausible</span></span>
<span><span class="va">pop_none</span> <span class="op">&lt;-</span>  <span class="va">nf_thresh_none</span> <span class="op">*</span> <span class="op">(</span><span class="va">pop_ss_none</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">pop_ss_none</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pop_thresh_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pop_none</span><span class="op">)</span><span class="op">)</span> <span class="co">#164</span></span>
<span></span>
<span><span class="co"># Using this approach the population triples.</span></span>
<span><span class="va">nohunt_t10_stoch</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, </span>
<span>                                     vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, </span>
<span>                                     threshold<span class="op">=</span><span class="va">pop_thresh_none</span>, </span>
<span>                                     A_DD<span class="op">=</span><span class="va">pop_mat_100_none_highdens</span><span class="op">)</span></span>
<span><span class="va">data_adults_stoch10</span> <span class="op">&lt;-</span> <span class="va">nohunt_t10_stoch</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/Projection-plots.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_adults_stoch10</span>, type<span class="op">=</span><span class="st">'l'</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">'Time'</span>, </span>
<span>     ylab<span class="op">=</span><span class="st">'N adult females'</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/threshold-dd-3.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Now use simple threshold. Same result with 10 or 11.</span></span>
<span><span class="va">nohunt_t10_stoch2</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_threshold.html">project_threshold</a></span><span class="op">(</span><span class="va">pop_mat_100_none</span>, </span>
<span>                                     vector<span class="op">=</span><span class="va">pop_n</span>, time<span class="op">=</span><span class="fl">100</span>, </span>
<span>                                     threshold<span class="op">=</span><span class="fl">11</span>, </span>
<span>                                     A_DD<span class="op">=</span><span class="va">pop_mat_100_none_highdens</span><span class="op">)</span></span>
<span><span class="va">data_adults_t10_stoch2</span> <span class="op">&lt;-</span> <span class="va">nohunt_t10_stoch2</span><span class="op">$</span><span class="va">vec</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/Projection-plots.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_adults_t10_stoch2</span>, type<span class="op">=</span><span class="st">'l'</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">'Time'</span>, </span>
<span>     ylab<span class="op">=</span><span class="st">'N adult females'</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03_Adult-survival-scenarios_files/figure-html/threshold-dd-4.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_adults_t10_stoch2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   10.00   11.61   11.72   11.72   11.88   12.31</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="senesence">Senesence?<a class="anchor" aria-label="anchor" href="#senesence"></a>
</h2>
<p>As turtles are long lived species, the populations are highly
sensitive to adult survival rates (Heppell 1998). Within stage-based
matrix models this can be better explored by splitting adults into three
stages:</p>
<ul>
<li><p>young adult,<br>
with lower survival and fecundity due to smaller body sizes.</p></li>
<li><p>mature adults,<br>
with greatest survival and fecundity due to body sizes and general
health.</p></li>
<li><p>elderly adults,<br>
with lower survival and fecundity due to senescence.</p></li>
</ul>
<p>There appears to be considerable variation in senesence in reptiles,
and there are few data available that evaluate senesence in long-lived
turtles (Reinke et al. 2022). But the available evidence suggests
reproduction and survival can decline with age (Warner et. al. 2016).
For example, despite relatively high reproductive output, older females
produced eggs with reduced hatching success (Congdon et. al. 2001,
Warner et. al. 2016). A study from zoos and aquariums also showed that
turtles and tortoises may reduce senescence in response to improvements
in environmental conditions (da Silva et. al. 2022). This raises the
possibility that improved environmental management can reduce senesence
in freshwater turtles.</p>
<p>There is no data available for <em>Podocnemis unifilis</em> on
differences in survival/fecundity with age of adult females. So here we
use data from other turtle species with similar life history and
demographic characteristics. This includes <em>Podocenmis expansa</em> -
where survival of different adult stages has been documented (Mogollones
et. al. 2010). The Matrix Population Models developed in this study and
others are freely available from the COMADRE database (<a href="https://compadre-db.org/Data/Comadre" class="external-link uri">https://compadre-db.org/Data/Comadre</a>). Here we use a
subset from COMADRE version 4.23.3.1 created on 24 March 2023.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data for Podocnemididae</span></span>
<span><span class="co"># A COM(P)ADRE database ('CompadreDB') object with 2 SPECIES and 2 MATRICES.</span></span>
<span><span class="va">comadre_podoc</span></span>
<span><span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with 2 SPECIES and 2 MATRICES.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 59</span></span></span>
<span><span class="co">#&gt;   mat        MatrixID SpeciesAuthor    SpeciesAccepted CommonName Kingdom Phylum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>   <span style="text-decoration: underline;">250</span>117 Podocnemis_lewy… Podocnemis lew… Magdalena… Animal… Chord…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>   <span style="text-decoration: underline;">250</span>118 Podocnemis_expa… Podocnemis exp… Arrau tur… Animal… Chord…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MatrixCriteriaSize &lt;chr&gt;, MatrixCriteriaOntogeny &lt;chr&gt;, …</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>da Silva, R., Conde, D. A., Baudisch, A., &amp; Colchero, F. 2022.
Slow and negligible senescence among testudines challenges evolutionary
theories of senescence. Science, 376 (6600), 1466-1470. <a href="https://doi.org/10.1126/science.abl7811" class="external-link uri">https://doi.org/10.1126/science.abl7811</a></p>
<p>Congdon, J. D. et. al. 2001. Hypotheses of aging in a long-lived
vertebrate, Blanding’s turtle (Emydoidea blandingii). Experimental
gerontology, 36(4-6), 813-827. <a href="https://doi.org/10.1016/S0531-5565(00)00242-4" class="external-link uri">https://doi.org/10.1016/S0531-5565(00)00242-4</a></p>
<p>Heppell, S. S. 1998. Application of life-history theory and
population model analysis to turtle conservation. Copeia, 367-375. <a href="https://doi.org/10.2307/1447430" class="external-link uri">https://doi.org/10.2307/1447430</a></p>
<p>Mogollones SC, Rodríguez DJ, Hernández O, Barreto GR. 2010.<br>
A demographic study of the arrau turtle (Podocnemis expansa) in the
Middle Orinoco River, Venezuela. Chelonian Conservation and Biology. Jun
1;9(1):79-89. <a href="https://doi.org/10.2744/CCB-0778.1" class="external-link uri">https://doi.org/10.2744/CCB-0778.1</a></p>
<p>Reinke et al. 2022. Diverse aging rates in ectothermic tetrapods
provide insights for the evolution of aging and longevity. Science
376,1459-1466. <a href="https://doi.org/10.1126/science.abm0151" class="external-link uri">https://doi.org/10.1126/science.abm0151</a></p>
<p>Warner, D. A., Miller, D. A., Bronikowski, A. M., &amp; Janzen, F. J.
2016. Decades of field data reveal that turtles senesce in the wild.
Proceedings of the National Academy of Sciences, 113(23), 6502-6507. <a href="https://doi.org/10.1073/pnas.1600035113" class="external-link uri">https://doi.org/10.1073/pnas.1600035113</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Darren Norris.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
